# API Idempotency (冪等)

## API 的穩定性



## 如何實現冪等性？

對於 RESTful API 而言，`GET`, `PUT`, `DELETE` 等請求都不需要擔心冪等性。

解釋：

- `GET`: 就算多次請求，資料庫中的資料還是不會改變，所以不影響最後從資料庫拿到的資料
- `PUT`: 若有多次請求，就以最後一個請求為主來更新資料庫。
- `DELETE`: 在刪除某個資源後，後面的 `DELETE` 請求也會因為資源已經被刪除而不受影響。

但是在 `POST` 請求則需要特別處理。

最常見用來達到冪等性的方式是透過「冪等鑰 (idempotent key)」。冪等鑰是一個 unique `id`，目的是讓伺服器知道這筆交易已經被執行過了。

例如，我們可以拿使用者的 `uuid` 來產生一組冪等鑰，並且這組鑰匙通常會在某段時間內過期（Time To Live, TTL），例如說是 24 小時，若是同一個使用者在 24 內送出同一筆 `POST` 請求，這時伺服器就會知道這個使用者在 24 小時內已經送了同一筆交易，便不會執行。
